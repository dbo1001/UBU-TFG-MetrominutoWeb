{% extends "base_template.html" %}

{% block content %}>
<script>
    var markers = [];
    var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    var labelIndex = 0;
    var directionsService = new google.maps.DirectionsService;
    var directionsRenderer = new google.maps.DirectionsRenderer;
    function initMap() {
            //var myLatLng = {lat: 42.34, lng: -3.69};
            var myLatLng = {lat: {{latitud}}, lng: {{longitud}} };
            var map = new google.maps.Map(document.getElementById('map'), {
                zoom: 12,
                center: myLatLng
            });
            google.maps.event.addListener(map, 'click', function(event) {
                addMarker(event.latLng, map);
            });
            document.getElementById('submit').addEventListener('click', function() {
                calculateAndDisplayRoute(directionsService, directionsRenderer);
            });
            var marker = new google.maps.Marker({
                position: {lat: 42.343455, lng: -3.702989},
                map: map,
                title : "A"
            });
        }
        function addMarker(location, map) {
            var marker = new google.maps.Marker({
                position: location,
                label: labels[labelIndex++ % labels.length],
                map: map
            });
            markers.push(marker);
        }
        function setMapOnAll(map) {
            for (var i = 0; i < markers.length; i++) {
                markers[i].setMap(map);
            }
        }
        function clearMarkers() {
            setMapOnAll(null);
        }
        // Deletes all markers in the array by removing references to them.
        function deleteMarkers() {
            clearMarkers();
            markers = [];
            labelIndex = 0;
        }
        function showMarkersDiv() {
            var summaryPanel = document.getElementById('directions-panel');
            summaryPanel.innerHTML = '';
            for (var i=0;i<markers.length;i++){
                summaryPanel.innerHTML += markers[i].label + ': ' + markers[i].position + '<br>';
            }
        }

        function save_markers() {
            $.post('/getMarks', {
                data: markers.length,

            }).done(function(response) {
               console.debug("Error")
            }).fail(function() {

            });

        }

        function draw_route(){

        }

        google.maps.event.addDomListener(window, 'load', initMap);
</script>

<form>
    <div id="map"></div>
    <input onclick="showMarkersDiv();" type=button value="Mostrar">
    <input onclick="deleteMarkers();" type=button value="Delete Markers">
    <input onclick="draw_route();" type="button" value="Dibujar">
{#    <input onclick="save_markers();" type=button value="Guardar">#}
{#    <input type="submit" id="submit">#}
    <div id = "directions-panel"></div>
</form>
{#<script>#}
{#    $(document).ready(function boxes(){#}
{#        var markers = [];#}
{#        var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';#}
{#        var labelIndex = 0;#}
{#        $("#showButton").click(function () {#}
{#            showMarkersDiv();#}
{#        });#}
{#        $("#removeButton").click(function () {#}
{#            deleteMarkers();#}
{#        });#}
{#        $("#saveButton").click(function () {#}
{#            $.ajax({#}
{#                type: "POST",#}
{#                contentType: "application/json;charset=utf-8",#}
{#                url: "/getMarks",#}
{#                traditional: "true",#}
{#                data: JSON.stringify (markers.length),#}
{#                dataType: "json"#}
{#            });#}
{#        });#}
{#       #}
{#    });#}
{#</script>#}

{% endblock %}